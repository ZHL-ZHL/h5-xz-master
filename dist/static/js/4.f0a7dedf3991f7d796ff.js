webpackJsonp([4],{"0b1b":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("Xxa5"),s=e.n(r),n=e("exGp"),i=e.n(n),c=e("teIl"),o=e("TVmP"),d=e("eMjc"),u=e.n(d),l={props:{id:0},computed:{avatar:function(){return localStorage.getItem("avatar")},nickname:function(){return localStorage.getItem("nickname")}},data:function(){return{res:{},src:"",show:!1,urlImg:""}},methods:{share:function(){var t=this;this.show=!0,this.urlImg||u()(document.querySelector(".main"),{allowTaint:!1,useCORS:!0}).then(function(a){t.urlImg=a.toDataURL()})},getCardDetail:function(){var t=this;return i()(s.a.mark(function a(){var e,r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e=void 0,"norandom"!=t.$route.params.type){a.next=8;break}return a.next=4,t.$http.get("card/"+t.id);case 4:e=a.sent,t.res=e.data,a.next=28;break;case 8:if(1!=t.$route.params.isdailyfortune){a.next=23;break}return a.next=11,t.$http.get("card/record/day");case 11:if(!(e=a.sent).data){a.next=16;break}t.res=e.data,a.next=21;break;case 16:return a.next=18,t.$http.get("card/random",{params:{category_id:t.$route.params.id}});case 18:r=a.sent,t.save(r.data.id),t.res=r.data;case 21:a.next=28;break;case 23:return a.next=25,t.$http.get("card/random",{params:{category_id:t.$route.params.id}});case 25:e=a.sent,t.save(e.data.id),t.res=e.data;case 28:t.src=t.res.icon,t.$nextTick(function(){u()(document.querySelector(".main"),{allowTaint:!1,useCORS:!0}).then(function(a){t.urlImg=a.toDataURL()})});case 30:case"end":return a.stop()}},a,t)}))()},save:function(t){var a=this;return i()(s.a.mark(function e(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.$http.post("card/record/day/create",{card_id:t});case 2:200==(r=e.sent).code?localStorage.setItem("savetime",(new Date).getTime()):alert(r.msg);case 4:case"end":return e.stop()}},e,a)}))()}},mounted:function(){this.getCardDetail()},components:{Header:c.a,Footer:o.a}},v={render:function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("div",{},[r("Header"),t._v(" "),"norandom"!==t.$route.params.type?r("div",{staticClass:"share",on:{click:t.share}},[t._v("分享")]):t._e(),t._v(" "),r("div",{staticClass:"main"},[r("div",{staticClass:"user"},[r("div",{staticClass:"avatar"},[t.avatar?r("img",{attrs:{src:t.avatar,alt:""}}):r("img",{attrs:{src:e("zQrT"),alt:""}})]),t._v(" "),r("div",{staticClass:"nickname"},[t._v(t._s(t.nickname))])]),t._v(" "),r("div",{staticClass:"star"},[r("div",{staticClass:"container"},[r("div",{staticClass:"img"},[r("img",{attrs:{src:t.src,alt:""}})]),t._v(" "),r("div",{staticClass:"title"},[t._v(t._s(t.res.title))]),t._v(" "),r("div",{staticClass:"des",domProps:{innerHTML:t._s(t.res.content)}})])])]),t._v(" "),"norandom"==t.$route.params.type?r("Footer",{attrs:{my:!0}}):t._e(),t._v(" "),"norandom"!==t.$route.params.type?r("Footer",{attrs:{on:!0}}):t._e(),t._v(" "),r("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[r("div",{staticClass:"popup"},[r("div",{staticClass:"top"},[r("div",{staticClass:"colse"},[t._v("长按下图保存分享")])]),t._v(" "),r("span",{staticClass:"cha iconfont icon-cha",on:{click:function(a){t.show=!1}}}),t._v(" "),r("div",{staticClass:"img-box"},[r("img",{staticClass:"share-img",attrs:{src:e("TUKC"),alt:""}})])])])],1)},staticRenderFns:[]};var m=e("VU/8")(l,v,!1,function(t){e("CZKd"),e("UzuQ")},"data-v-26a40d54",null);a.default=m.exports},CZKd:function(t,a){},UzuQ:function(t,a){}});
//# sourceMappingURL=4.f0a7dedf3991f7d796ff.js.map