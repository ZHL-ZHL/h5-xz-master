webpackJsonp([13],{"Wg+5":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),s=n.n(a),i=n("exGp"),o=n.n(i),r=n("bOdI"),c=n.n(r),l=(n("NC6I"),n("mtWM"),{props:{openid:""},data:function(){return c()({mobile:"",code:"",res:"",time:60,isShow:!0,timer:null},"code","")},updated:function(){},mounted:function(){},created:function(){var e=this;return o()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.getUrlParam("code"))){t.next=8;break}return t.next=4,e.getOpenid(n);case 4:return a=t.sent,t.next=7,e.wLongin(a);case 7:t.sent;case 8:case"end":return t.stop()}},t,e)}))()},methods:{bind:function(e){var t=this;return o()(s.a.mark(function e(){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(/^\d{11}$/.test(t.mobile)){e.next=3;break}return t.$dialog.alert({message:"请输入正确的手机号"}).then(function(){}),e.abrupt("return",!1);case 3:return e.next=5,t.$http.post("auth/wx/bind_phone",{code:t.code,mobile:t.mobile,openid:t.openid});case 5:if(200!=e.sent.code){e.next=11;break}return e.next=9,t.$http.post("auth/wx/login/"+t.openid);case 9:200==(n=e.sent).code?(localStorage.setItem("token",n.data.token),localStorage.getItem("url")?window.location.href=localStorage.getItem("url"):t.$router.push({name:"main"})):alert(n.msg);case 11:case"end":return e.stop()}},e,t)}))()},getValidCode:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(/^\d{11}$/.test(e.mobile)){t.next=3;break}return e.$dialog.alert({message:"请输入正确的手机号"}).then(function(){}),t.abrupt("return",!1);case 3:return t.next=5,e.$http.get("sms/send/"+e.mobile+"/3");case 5:200==t.sent.code&&(e.isShow=!1,e.timer=setInterval(function(){e.$nextTick(function(){e.time--}),e.time<=0&&(e.isShow=!0,clearInterval(e.timer),e.timer=null,e.time=60)},1e3));case 7:case"end":return t.stop()}},t,e)}))()}}}),u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-login"},[n("router-link",{staticClass:"back",attrs:{tag:"div",to:{name:"main"}}}),e._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[e._v("\n      绑定手机号\n    ")]),e._v(" "),n("div",{staticClass:"input-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.mobile,expression:"mobile"}],staticClass:"username",attrs:{type:"tel",placeholder:"手机号"},domProps:{value:e.mobile},on:{input:function(t){t.target.composing||(e.mobile=t.target.value)}}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.mobile,expression:"mobile"}],staticClass:"close",on:{click:function(t){e.mobile=""}}})]),e._v(" "),n("div",{staticClass:"input-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"password",attrs:{type:"number",placeholder:"验证码"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.code,expression:"code"}],staticClass:"close",on:{click:function(t){e.code=""}}}),e._v(" "),n("div",{staticClass:"send-code"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"send",on:{click:e.getValidCode}},[e._v("发送验证码")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"time"},[e._v(e._s(e.time)+"s")])])])]),e._v(" "),n("div",{staticClass:"login",on:{click:e.bind}},[e._v("\n    绑定\n  ")])],1)},staticRenderFns:[]};var d=n("VU/8")(l,u,!1,function(e){n("dSgu")},"data-v-463cb18e",null);t.default=d.exports},dSgu:function(e,t){}});
//# sourceMappingURL=13.be130dc447d940d39efc.js.map