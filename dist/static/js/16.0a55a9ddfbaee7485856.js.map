{"version":3,"sources":["webpack:///src/views/Wlogin.vue","webpack:///./src/views/Wlogin.vue?35f6","webpack:///./src/views/Wlogin.vue"],"names":["Wlogin","data","defineProperty_default","mobile","code","res","time","isShow","timer","updated","mounted","created","_this","this","asyncToGenerator_default","regenerator_default","a","mark","_callee","openid","wrap","_context","prev","next","getUrlParam","getOpenid","sent","wLongin","wechateLogin","stop","methods","setCookie","name","value","exp","Date","setTime","getTime","Days","document","cookie","escape","toGMTString","getCookie","arr","reg","RegExp","match","unescape","delCookie","cval","getContent","ele","iframe","contentWindow","getElementById","innerHTML","replace","JSON","parse","setTimeout","login","_this2","_callee2","res2","_context2","test","abrupt","$http","post","localStorage","setItem","token","get","nickname","substr","gender","avatar","level","$router","push","getValidCode","_this3","_callee3","_context3","setInterval","$nextTick","clearInterval","views_Wlogin","render","_h","$createElement","_self","_c","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/16.0a55a9ddfbaee7485856.js","sourcesContent":["<template>\n  <div></div>\n</template>\n\n<script>\nimport md5 from \"js-md5\";\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      mobile: \"\",\n      code: \"\",\n      res: \"\",\n      time: 60,\n      isShow: true,\n      timer: null,\n      code: \"\"\n    };\n  },\n  updated() {\n    // alert('update'+location.href)\n  },\n  mounted() {\n    // alert('mounted'+location.href)\n  },\n  async created() {\n    let code = this.getUrlParam(\"code\");\n    // alert(code)\n    if (code) {\n      let openid = await this.getOpenid(code);\n      // alert(`openid: ${openid}`)\n      let res = await this.wLongin(openid);\n    } else {\n      this.wechateLogin();\n    }\n  },\n  methods: {\n    setCookie(name, value) {\n      var Days = 30;\n      var exp = new Date();\n      exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);\n      document.cookie =\n        name + \"=\" + escape(value) + \";expires=\" + exp.toGMTString();\n    },\n\n    //读取cookies\n    getCookie(name) {\n      var arr,\n        reg = new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\");\n\n      if ((arr = document.cookie.match(reg))) return unescape(arr[2]);\n      else return null;\n    },\n\n    //删除cookies\n    delCookie(name) {\n      var exp = new Date();\n      exp.setTime(exp.getTime() - 1);\n      var cval = getCookie(name);\n      if (cval != null)\n        document.cookie = name + \"=\" + cval + \";expires=\" + exp.toGMTString();\n    },\n\n    getContent() {\n      let ele = iframe.contentWindow.document.getElementById(\"iToolCode\");\n      // console.log( iframe.contentWindow.document.getElementById('t').innerHTML )\n      if (!ele) {\n        // n++;\n        setTimeout(this.getContent, 200);\n      } else {\n        let res = ele.innerHTML;\n        res = res.replace(/<span.+?>/g, \"\").replace(/<\\/span>/g, \"\");\n        // alert(res);\n        res = JSON.parse(res);\n        this.res = res;\n        // alert(res.data.open_id);\n      }\n    },\n    async login() {\n      if (!/^\\d{11}$/.test(this.mobile)) {\n        return false;\n      }\n      const res = await this.$http.post(\"auth/verification_code/login\", {\n        mobile: this.mobile,\n        code: this.code\n      });\n      if (res.code == 200) {\n        // this.$message({\n        //   type: \"success\",\n        //   message: \"登录成功\"\n        // });\n        localStorage.setItem(\"token\", res.data.token);\n        let res2 = await this.$http.get(`auth/info`);\n        if (res2.code == 200) {\n          localStorage.setItem(\n            \"nickname\",\n            res2.data.nickname || `手机用户${res2.data.mobile.substr(-4)}`\n          );\n          localStorage.setItem(\"gender\", res2.data.gender);\n          localStorage.setItem(\"avatar\", res2.data.avatar);\n          localStorage.setItem(\"level\", res2.data.level);\n        }\n        this.$router.push({ name: 'main' })\n      } else {\n        // this.$message({\n        //   type: \"error\",\n        //   message: res.data.msg\n        // });\n      }\n    },\n\n    async getValidCode() {\n      const res = await this.$http.get(`sms/send/${this.mobile}/4`);\n      if (res.code == 200) {\n        this.isShow = false;\n        this.timer = setInterval(() => {\n          this.$nextTick(() => {\n            this.time--;\n          });\n\n          if (this.time <= 0) {\n            this.isShow = true;\n            clearInterval(this.timer);\n            this.timer = null;\n            this.time = 60;\n          }\n        }, 1000);\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.page-login {\n  height: 100vh;\n  width: 101vw; //这个地方如果不设置101vw,右上位置的背景图片会有一个小小的白色间隙\n  background: url(\"../assets/img/login-2x.png\") no-repeat;\n  background-size: cover;\n  position: relative;\n  padding: 40px 60px 0;\n  .back {\n    width: 72px;\n    height: 67px;\n    background: url(\"../assets/img/return.png\") no-repeat;\n    background-size: cover;\n    position: absolute;\n    top: 40px;\n    left: 0px;\n  }\n  .container {\n    // width: 630px;\n    .title {\n      font-size: 60px;\n      // margin: 0 auto;\n      text-align: center;\n      color: #fff;\n      margin-bottom: 122px;\n    }\n    .input-box {\n      width: 100%;\n      position: relative;\n      margin-bottom: 88px;\n      input {\n        width: 100%;\n        border: none;\n        background: transparent;\n        color: #fff;\n        font-size: 28px;\n        line-height: 3em;\n        border-bottom: 1px solid #4f19a2;\n      }\n      .close {\n        width: 40px;\n        height: 40px;\n        background: url(\"../assets/img/close.png\") no-repeat;\n        background-size: contain;\n        border-radius: 50%;\n        position: absolute;\n        right: 0px;\n        bottom: 28px;\n      }\n      .send-code {\n        color: #a19ab9;\n        font-size: 28px;\n        position: absolute;\n        right: 68px;\n        bottom: 28px;\n      }\n    }\n  }\n  .login {\n    width: 690px;\n    height: 96px;\n    margin: 0 -30px;\n    background: linear-gradient(\n      90deg,\n      rgba(72, 197, 255, 1),\n      rgba(144, 77, 255, 1)\n    );\n    border-radius: 0px 48px 48px 72px;\n    font-size: 36px;\n    // font-family:PingFang SC;\n    // font-weight:bold;\n    color: rgba(255, 255, 255, 1);\n    line-height: 96px;\n    text-align: center;\n  }\n  .wechat-login {\n    position: relative;\n    margin: 125px 100px 0;\n    display: flex;\n    .text {\n      color: #9c8dbe;\n      font-size: 26px;\n      width: 170px;\n      // flex: 1;\n      text-align: center;\n      // z-index: 100;\n    }\n    .line {\n      width: 145px;\n      height: 3px;\n      background: rgba(79, 25, 162, 1);\n      margin-top: 11px;\n    }\n  }\n  .wechat-icon {\n    height: 60px;\n    width: 60px;\n    margin-left: 285px;\n    margin-top: 50px;\n    background: url(\"../assets/img/wechat.png\") no-repeat;\n    background-size: contain;\n  }\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/views/Wlogin.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-18baacc1\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/Wlogin.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-18baacc1\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":75}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Wlogin.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Wlogin.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Wlogin.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-18baacc1\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Wlogin.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-18baacc1\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Wlogin.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}